define(["jquery","core/log","mod_cpassignment/dialogs"],function(a,b,c){"use strict";return b.debug("cpassignment grading helper: initialising"),{controls:{},mediatype:null,hiddenplayer:"mod_cpassignment_hidden_player",hiddenplayerbutton:"mod_cpassignment_hidden_player_button",hiddenvideoplayer:"mod_cpassignment_hidden_video_player",videoplayercontainer:"mod_cpassignment_hiddenvideocontainer",activebutton:"mod_cpassignment_hidden_player_button_active",activebuttonpaused:"mod_cpassignment_hidden_player_button_paused",activebuttonplaying:"mod_cpassignment_hidden_player_button_playing",init:function(a){this.mediatype=a.mediatype,this.hiddenplayer=a.hiddenplayerclass,this.hiddenplayerbutton=a.hiddenplayerbuttonclass,this.register_controls(),this.register_events()},register_controls:function(){this.controls.hiddenplayer=a("."+this.hiddenplayer),this.controls.hiddenvideoplayer=a("."+this.hiddenvideoplayer),this.controls.hiddenplayerbutton=a("."+this.hiddenplayerbutton)},register_events:function(){var b=this,c=this.controls.hiddenplayer;this.controls.hiddenplayerbutton.click(function(d){switch(b.mediatype){case"video":var e=a(this).attr("data-audiosource");b.dohiddenvideoplay(e);break;case"audio":default:var e=a(this).attr("data-audiosource");e!=c.attr("src")||c.prop("paused")?b.dohiddenaudioplay(e):b.dohiddenstop()}})},dohiddenaudioplay:function(a){var b=this,c=b.controls.hiddenplayer;c.attr("src",a),c[0].pause(),c[0].load();var d=c[0].play();void 0!==d&&d.then(function(){})["catch"](function(a){}),b.dobuttonicons()},dohiddenvideoplay:function(a){var b=this,d=b.controls.hiddenvideoplayer;d.attr("src",a),d[0].pause(),d[0].load();var e=d[0].play();void 0!==e&&e.then(function(){})["catch"](function(a){}),c.openModal("#"+b.videoplayercontainer),b.dobuttonicons()},dohiddenstop:function(){var a=this,b=a.controls.hiddenplayer;b[0].pause(),a.dobuttonicons()},dobuttonicons:function(b){var c=this,d=c.controls.hiddenplayer;b||(b=d.attr("src")),c.controls.hiddenplayerbutton.each(function(e){var f=a(this).attr("data-audiosource");f==b?(a(this).addClass(c.activebutton),d.prop("paused")?(a(this).removeClass(c.activebuttonplaying),a(this).addClass(c.activebuttonpaused),a(this).removeClass(c.activebutton)):(a(this).removeClass(c.activebuttonpaused),a(this).addClass(c.activebuttonplaying))):(a(this).removeClass(c.activebutton),a(this).removeClass(c.activebuttonplaying),a(this).removeClass(c.activebuttonpaused))})}}});