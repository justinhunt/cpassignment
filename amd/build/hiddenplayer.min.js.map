{"version":3,"file":"hiddenplayer.min.js","sources":["../src/hiddenplayer.js"],"sourcesContent":["define(['jquery', 'core/log','mod_cpassignment/dialogs'], function($,log,dialogs) {\n    \"use strict\"; // jshint ;_;\n\n    log.debug('cpassignment hidden player: initialising');\n\n    return {\n\n        controls: {},\n        mediatype: null,\n        overallcontainer: 'mod_cpassignment_attempts_cont',\n        hiddenplayer: 'mod_cpassignment_hidden_player',\n        hiddenplayerbutton: 'mod_cpassignment_hidden_player_button',\n        hiddenvideoplayer: 'mod_cpassignment_hidden_video_player',\n        videoplayercontainer: 'mod_cpassignment_hiddenvideocontainer',\n        activebutton: 'mod_cpassignment_hidden_player_button_active',\n        activebuttonpaused: 'mod_cpassignment_hidden_player_button_paused',\n        activebuttonplaying: 'mod_cpassignment_hidden_player_button_playing',\n\n        init: function (opts) {\n            this.mediatype = opts['mediatype'];\n            this.hiddenplayer = opts['hiddenplayerclass'];\n            this.hiddenplayerbutton = opts['hiddenplayerbuttonclass'];\n            this.register_controls();\n            this.register_events();\n        },\n\n        register_controls: function(){\n            this.controls.overallcontainer = $('.' + this.overallcontainer);\n            this.controls.hiddenplayer = $('.' + this.hiddenplayer);\n            this.controls.hiddenvideoplayer = $('.' + this.hiddenvideoplayer);\n            this.controls.hiddenplayerbutton = $('.' + this.hiddenplayerbutton);\n        },\n\n        register_events: function(){\n            var that = this;\n            var audioplayer = this.controls.hiddenplayer;\n            //handle the button click\n           // this.controls.overallcontainer.on('click','.' + this.hiddenplayerbutton, function(e){\n            $('body').on('click','.' + this.hiddenplayerbutton, function(e){\n                switch(that.mediatype){\n\n                    case 'video':\n                        var mediasrc = $(this).attr('data-audiosource');\n                        that.dohiddenvideoplay(mediasrc);\n                        break;\n\n                    case 'audio':\n                    default:\n                        var mediasrc = $(this).attr('data-audiosource');\n                        if (mediasrc == audioplayer.attr('src') && !(audioplayer.prop('paused'))) {\n                            that.dohiddenstop();\n                        } else {\n                            that.dohiddenaudioplay(mediasrc);\n                        }\n                }\n\n            });\n\n        },\n\n\n        dohiddenaudioplay: function (mediasrc) {\n            var m = this;\n            var audioplayer = m.controls.hiddenplayer;\n            audioplayer.attr('src', mediasrc);\n            audioplayer[0].pause();\n            audioplayer[0].load();\n            var pp = audioplayer[0].play();\n            if (pp !== undefined) {\n                pp.then(function() {\n                    // Yay we are playing\n                }).catch(function(error) {\n                    // somethings up ... but we can ignore it\n                });\n            }\n            m.dobuttonicons();\n        },\n\n        dohiddenvideoplay: function(mediasrc){\n\n            var m = this;//M.mod_cpassignment.gradinghelper;\n            var videoplayer = m.controls.hiddenvideoplayer;\n            videoplayer.attr('src', mediasrc);\n            videoplayer[0].pause();\n            videoplayer[0].load();\n            var pp = videoplayer[0].play();\n            if (pp !== undefined) {\n                pp.then(function() {\n                    // Yay we are playing\n                }).catch(function(error) {\n                    // somethings up ... but we can ignore it\n                });\n            }\n            dialogs.openModal('#' + m.videoplayercontainer);\n            m.dobuttonicons();\n        },\n\n        dohiddenstop: function () {\n            var m = this;// M.mod_cpassignment.gradinghelper;\n            var audioplayer =  m.controls.hiddenplayer;\n            audioplayer[0].pause();\n            m.dobuttonicons();\n        },\n\n        dobuttonicons: function (theaudiosrc) {\n            var m = this;//M.mod_cpassignment.gradinghelper;\n            var audioplayer = m.controls.hiddenplayer;\n            if (!theaudiosrc) {\n                theaudiosrc = audioplayer.attr('src');\n            }\n            m.controls.hiddenplayerbutton.each(function (index) {\n                var audiosrc = $(this).attr('data-audiosource');\n                if (audiosrc == theaudiosrc) {\n                    $(this).addClass(m.activebutton);\n                    if (audioplayer.prop('paused')) {\n                        $(this).removeClass(m.activebuttonplaying);\n                        $(this).addClass(m.activebuttonpaused);\n                        //for now we make it look like no button is selected\n                        //later we can implement better controls\n                        $(this).removeClass(m.activebutton);\n                    } else {\n                        $(this).removeClass(m.activebuttonpaused);\n                        $(this).addClass(m.activebuttonplaying);\n                    }\n                } else {\n                    $(this).removeClass(m.activebutton);\n                    $(this).removeClass(m.activebuttonplaying);\n                    $(this).removeClass(m.activebuttonpaused);\n                }\n            });\n        }\n    };//end of return object\n\n});"],"names":["define","$","log","dialogs","debug","controls","mediatype","overallcontainer","hiddenplayer","hiddenplayerbutton","hiddenvideoplayer","videoplayercontainer","activebutton","activebuttonpaused","activebuttonplaying","init","opts","register_controls","register_events","this","that","audioplayer","on","e","mediasrc","attr","dohiddenvideoplay","prop","dohiddenaudioplay","dohiddenstop","pause","load","pp","play","undefined","then","catch","error","dobuttonicons","m","videoplayer","openModal","theaudiosrc","each","index","addClass","removeClass"],"mappings":"AAAAA,uCAAO,CAAC,SAAU,WAAW,6BAA6B,SAASC,EAAEC,IAAIC,gBAGrED,IAAIE,MAAM,4CAEH,CAEHC,SAAU,GACVC,UAAW,KACXC,iBAAkB,iCAClBC,aAAc,iCACdC,mBAAoB,wCACpBC,kBAAmB,uCACnBC,qBAAsB,wCACtBC,aAAc,+CACdC,mBAAoB,+CACpBC,oBAAqB,gDAErBC,KAAM,SAAUC,WACPV,UAAYU,KAAI,eAChBR,aAAeQ,KAAI,uBACnBP,mBAAqBO,KAAI,6BACzBC,yBACAC,mBAGTD,kBAAmB,gBACVZ,SAASE,iBAAmBN,EAAE,IAAMkB,KAAKZ,uBACzCF,SAASG,aAAeP,EAAE,IAAMkB,KAAKX,mBACrCH,SAASK,kBAAoBT,EAAE,IAAMkB,KAAKT,wBAC1CL,SAASI,mBAAqBR,EAAE,IAAMkB,KAAKV,qBAGpDS,gBAAiB,eACTE,KAAOD,KACPE,YAAcF,KAAKd,SAASG,aAGhCP,EAAE,QAAQqB,GAAG,QAAQ,IAAMH,KAAKV,oBAAoB,SAASc,MAGhD,UAFFH,KAAKd,eAGAkB,SAAWvB,EAAEkB,MAAMM,KAAK,oBAC5BL,KAAKM,kBAAkBF,gBAKnBA,SAAWvB,EAAEkB,MAAMM,KAAK,sBACZJ,YAAYI,KAAK,QAAYJ,YAAYM,KAAK,UAG1DP,KAAKQ,kBAAkBJ,UAFvBJ,KAAKS,oBAWzBD,kBAAmB,SAAUJ,cAErBH,YADIF,KACYd,SAASG,aAC7Ba,YAAYI,KAAK,MAAOD,UACxBH,YAAY,GAAGS,QACfT,YAAY,GAAGU,WACXC,GAAKX,YAAY,GAAGY,YACbC,IAAPF,IACAA,GAAGG,MAAK,eAELC,OAAM,SAASC,WATdlB,KAaNmB,iBAGNZ,kBAAmB,SAASF,cAEpBe,EAAIpB,KACJqB,YAAcD,EAAElC,SAASK,kBAC7B8B,YAAYf,KAAK,MAAOD,UACxBgB,YAAY,GAAGV,QACfU,YAAY,GAAGT,WACXC,GAAKQ,YAAY,GAAGP,YACbC,IAAPF,IACAA,GAAGG,MAAK,eAELC,OAAM,SAASC,WAItBlC,QAAQsC,UAAU,IAAMF,EAAE5B,sBAC1B4B,EAAED,iBAGNT,aAAc,WACFV,KACad,SAASG,aAClB,GAAGsB,QAFPX,KAGNmB,iBAGNA,cAAe,SAAUI,iBACjBH,EAAIpB,KACJE,YAAckB,EAAElC,SAASG,aACxBkC,cACDA,YAAcrB,YAAYI,KAAK,QAEnCc,EAAElC,SAASI,mBAAmBkC,MAAK,SAAUC,OAC1B3C,EAAEkB,MAAMM,KAAK,qBACZiB,aACZzC,EAAEkB,MAAM0B,SAASN,EAAE3B,cACfS,YAAYM,KAAK,WACjB1B,EAAEkB,MAAM2B,YAAYP,EAAEzB,qBACtBb,EAAEkB,MAAM0B,SAASN,EAAE1B,oBAGnBZ,EAAEkB,MAAM2B,YAAYP,EAAE3B,gBAEtBX,EAAEkB,MAAM2B,YAAYP,EAAE1B,oBACtBZ,EAAEkB,MAAM0B,SAASN,EAAEzB,wBAGvBb,EAAEkB,MAAM2B,YAAYP,EAAE3B,cACtBX,EAAEkB,MAAM2B,YAAYP,EAAEzB,qBACtBb,EAAEkB,MAAM2B,YAAYP,EAAE1B"}