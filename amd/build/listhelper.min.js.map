{"version":3,"sources":["../src/listhelper.js"],"names":["define","$","cfg","log","Ajax","templates","ModalFactory","str","ModalEvents","cloudpoodll","dialogs","datatables","notification","debug","controls","modulecssclass","cmid","moduleid","strings","authmode","accesskey","max","init","props","hasOwnProperty","prepare_html","register_events","init_recorder","audiorecid","init_strings","that","i","length","get_string","then","stringdata","arecstartbutton","arecstartcontainer","shareboxbutton","shareboxresetkeybutton","sharebox","shareboxcopybutton","receiptscontainer","noitemscontainer","itemscontainer","areccontainer","rectable","itemnamefield","itemidfield","itemfilenamefield","itemsubidfield","dialogdownloadlink","dialogdownloadbutton","dialogdownloadname","downloadlinkcopybutton","deletebutton","downloadbutton","recordingsexceeded","show","thedatatable","getDataTable","click","val","openModal","show_sharebox","create","type","types","SAVE_CANCEL","title","body","modal","setSaveButtonText","root","getRoot","on","save","do_resetkey","copyText","select","setSelectionRange","document","execCommand","e","clickedLink","currentTarget","elementid","data","show_download","audiotitle","row","parents","remove","draw","itemcount","rows","count","hide","do_delete","check_item_count","addClass","removeClass","audiolink","attr","html","call","methodname","args","done","ajaxresult","payloadobject","JSON","parse","success","message","wwwroot","fail","exception","itemid","recorderid","console","status","mediaurl","filename","itemname","subid","send_submission","re_init_recorder","rec_div","empty","insert_new_item","item","render","add","acknowledge_receipt","prepend","closeModal","clear_recorder"],"mappings":"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","sourcesContent":["define(['jquery','core/config','core/log','core/ajax','core/templates','core/modal_factory','core/str','core/modal_events',\n        'mod_cpassignment/cloudpoodllloader','mod_cpassignment/dialogs','mod_cpassignment/datatables','core/notification'],\n    function($,cfg,log,Ajax, templates, ModalFactory, str, ModalEvents, cloudpoodll, dialogs, datatables,notification) {\n    \"use strict\"; // jshint ;_;\n\n    log.debug('cpassignment list helper: initialising');\n\n    return {\n        controls: {},\n        modulecssclass: null,\n        cmid: null,\n        moduleid: 0,\n        strings: [],\n        authmode: 'normal',\n        accesskey: '',\n        max: 0,\n\n        init: function(props){\n            this.modulecssclass = props.modulecssclass;\n            this.moduleid = props.moduleid;\n            this.cmid = props.cmid;\n            if(props.hasOwnProperty('authmode')){\n                this.authmode=props.authmode;\n            }\n            if(props.hasOwnProperty('accesskey')){\n                this.accesskey=props.accesskey;\n            }\n            if(props.hasOwnProperty('max')){\n                this.max=props.max;\n            }\n            this.prepare_html();\n            this.register_events();\n            //instantiate the recorders\n            this.init_recorder(this.audiorecid);\n            //cloudpoodll.autoCreateRecorders();\n        },\n\n        init_strings: function(){\n            var that = this;\n           var strings=['deletedialogtitle','deletedialogquestion','deletelabel'];\n           for(var i=0; i<strings.length; i++) {\n               str.get_string(strings[i],'mod_cpassignment').then(function (stringdata) {\n                   that.strings[i]=stringdata;\n               });\n           }\n        },\n\n        prepare_html: function(){\n            this.controls.arecstartbutton = $('#' + this.modulecssclass + '_listaudiorecstart');\n            this.controls.arecstartcontainer = $('.' + this.modulecssclass + '_listaudiorecstartcontainer');\n            this.controls.shareboxbutton = $('#' + this.modulecssclass + '_listshareboxstart');\n            this.controls.shareboxresetkeybutton = $('#' + this.modulecssclass + '_sharebox_resetkey_button');\n            this.controls.sharebox = $('#' + this.modulecssclass + '_sharebox');\n            this.controls.shareboxcopybutton = $('#' + this.modulecssclass + '_sharebox_copy_button');\n            this.controls.receiptscontainer = $('#' + this.modulecssclass + '_receipts_container');\n            this.controls.noitemscontainer = $('#' + this.modulecssclass + '_noitems_cont');\n            this.controls.itemscontainer = $('#' + this.modulecssclass + '_items_cont');\n            this.controls.areccontainer = $('#' + this.modulecssclass + '_arec_container');\n            this.controls.rectable = $('#' + this.modulecssclass + '_itemstable__opts_9999');\n            this.controls.itemnamefield = $('.itemform_itemname');\n            this.controls.itemidfield = $('.itemform_itemid');\n            this.controls.itemfilenamefield =$('.itemform_itemfilename');\n            this.controls.itemsubidfield =$('.itemform_itemsubid');\n            this.controls.dialogdownloadlink=$('#' + this.modulecssclass + '_download_link');\n            this.controls.dialogdownloadbutton=$('#' + this.modulecssclass + '_download_button');\n            this.controls.dialogdownloadname=$('#' + this.modulecssclass + '_download_name');\n            this.controls.downloadlinkcopybutton=$('#' + this.modulecssclass + '_download_copy_button');\n            this.audiorecid = 'therecorderid_mod_cpassignment_listaudiorec';\n            this.controls.deletebutton = $('#' + this.modulecssclass + '_itemstable__opts_9999 a[data-type=\"delete\"]');\n            this.controls.downloadbutton = $('#' + this.modulecssclass + '_itemstable__opts_9999 a[data-type=\"download\"]');\n            this.controls.recordingsexceeded = $('#' + this.modulecssclass + '_recordingsexceeded_cont');\n            this.controls.arecstartbutton.show();\n            this.controls.shareboxbutton.show();\n            this.controls.thedatatable = datatables.getDataTable(this.modulecssclass + '_itemstable__opts_9999');\n\n        },\n\n        register_events: function(){\n            var that =this;\n\n            //recorder dialog show link\n            this.controls.arecstartbutton.click(function(){\n                //clear fields\n                that.controls.itemfilenamefield.val(\"\");\n                that.controls.itemidfield.val(\"\");\n                that.controls.itemnamefield.val(\"\");\n                that.controls.itemsubidfield.val(\"0\");\n                dialogs.openModal('#' + that.modulecssclass + '_arec_container');\n            });\n\n            //sharebox\n            this.controls.shareboxbutton.click(function(){\n                that.show_sharebox();\n            });\n\n            //sharebox\n            this.controls.shareboxresetkeybutton.click(function(){\n                ModalFactory.create({\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    title: 'Reset the Public Link',\n                    body: 'Resetting the public link will change it and the previous link will no longer work anymore. Are you sure that you want to do this?'\n                })\n                .then(function(modal) {\n                    modal.setSaveButtonText('RESET');\n                    var root = modal.getRoot();\n                    root.on(ModalEvents.save, function() {\n                        that.do_resetkey(that, that.moduleid);\n                    });\n                    modal.show();\n                });\n                return false;\n            });\n\n            this.controls.shareboxcopybutton.click(function(){\n                var copyText = that.controls.sharebox[0];\n                /* Select the text field */\n                copyText.select();\n                copyText.setSelectionRange(0, 99999); /*For mobile devices*/\n\n                /* Copy the text inside the text field */\n                document.execCommand(\"copy\");\n            });\n\n            this.controls.downloadlinkcopybutton.click(function(){\n                var copyText = that.controls.dialogdownloadlink[0];\n                /* Select the text field */\n                copyText.select();\n                copyText.setSelectionRange(0, 99999); /*For mobile devices*/\n\n                /* Copy the text inside the text field */\n                document.execCommand(\"copy\");\n            });\n\n            //download links\n            this.controls.rectable.on('click','a[data-type=\"download\"]',function(e){\n                    var clickedLink = $(e.currentTarget);\n                    var elementid = clickedLink.data('id');\n                    that.show_download(that, elementid);\n                    return false;\n            });\n\n            //delete linkc\n            this.controls.rectable.on('click','a[data-type=\"delete\"]',function(e){\n                        var clickedLink = $(e.currentTarget);\n                        var elementid = clickedLink.data('id');\n                        var audiotitle = $('td.itemname span[data-itemid=\"'+ elementid+ '\"]').data('value');\n                        ModalFactory.create({\n                            type: ModalFactory.types.SAVE_CANCEL,\n                            title: 'Delete Media',\n                            body: 'Do you really want to delete audio? <i>' + audiotitle + '</i>',\n                        })\n                            .then(function(modal) {\n                                modal.setSaveButtonText('DELETE');\n                                var root = modal.getRoot();\n                                root.on(ModalEvents.save, function() {\n                                    that.controls.thedatatable.row( clickedLink.parents('tr')).remove().draw();\n                                    var itemcount = that.controls.thedatatable.rows().count();\n                                    if(!itemcount){\n                                        that.controls.noitemscontainer.show();\n                                        that.controls.itemscontainer.hide();\n                                    }\n                                    that.do_delete(elementid);\n                                    that.check_item_count(that);\n                                });\n                                modal.show();\n                            });\n                        return false;\n            });\n        },\n\n        check_item_count: function(that){\n          var itemcount =   that.controls.thedatatable.rows().count();\n          if(that.max > 0 && itemcount >= that.max){\n              that.controls.recordingsexceeded.show();\n              that.controls.arecstartcontainer.addClass('hide');\n          }else{\n              that.controls.recordingsexceeded.hide();\n              that.controls.arecstartcontainer.removeClass('hide');\n          }\n        },\n\n        show_download: function(that, elementid){\n            var audiotitle = $('td.itemname span[data-itemid=\"'+ elementid+ '\"]').data('value');\n            var audiolink = $('td.item audio[data-id=\"'+ elementid+ '\"]').attr('src');\n            that.controls.dialogdownloadlink.val(audiolink);\n            that.controls.dialogdownloadbutton.attr(\"href\",audiolink);\n            that.controls.dialogdownloadname.html('<h3>Download: ' +  audiotitle + '</h3>');\n            dialogs.openModal('#' + that.modulecssclass + '_download_container');\n        },\n\n        show_sharebox: function(){\n            var that =this;\n            dialogs.openModal('#' + that.modulecssclass + '_sharebox_container');\n        },\n\n        do_resetkey: function(that, moduleid){\n\n            Ajax.call([{\n                methodname: 'mod_cpassignment_reset_key',\n                args: {\n                    moduleid: moduleid,\n                },\n                done: function (ajaxresult) {\n                    var payloadobject = JSON.parse(ajaxresult);\n                    if (payloadobject) {\n                        switch(payloadobject.success) {\n                            case true:\n                                var accesskey = payloadobject.message;\n                                that.controls.sharebox.val(cfg.wwwroot + '/mod/cpassignment/k.php?k=' + accesskey);\n                                break;\n\n                            case false:\n                            default:\n                                if (payloadobject.message) {\n                                    log.debug('message: ' + payloadobject.message);\n                                }\n                        }\n                    }\n                },\n                fail: notification.exception\n            }]);\n\n        },\n\n        do_delete: function(itemid){\n\n            Ajax.call([{\n                methodname: 'mod_cpassignment_remove_rec',\n                args: {\n                    itemid: itemid,\n                },\n                done: function (ajaxresult) {\n                    var payloadobject = JSON.parse(ajaxresult);\n                    if (payloadobject) {\n                        switch(payloadobject.success) {\n                            case true:\n                                //all good do nothing\n                                break;\n\n                            case false:\n                            default:\n                                if (payloadobject.message) {\n                                    log.debug('message: ' + payloadobject.message);\n                                }\n                        }\n                    }\n                },\n                fail: notification.exception\n            }]);\n\n        },\n\n        init_recorder: function(recorderid){\n            var that = this;\n            cloudpoodll.init(recorderid,\n\n                function(message){\n                    console.log(message);\n                    switch(message.type){\n                        case 'recording':\n                            break;\n\n                        case 'awaitingprocessing':\n                            //awaitingprocessing fires often, but we only want to post once\n                            if(that.status!='posted') {\n                                //do something\n                            }\n                            that.status='posted';\n                            break;\n\n                        case 'filesubmitted':\n                            that.controls.itemfilenamefield.val(message.mediaurl);\n                            var filename=that.controls.itemfilenamefield.val();\n                            var itemid = that.controls.itemidfield.val();\n                            var itemname = that.controls.itemnamefield.val();\n                            var subid = that.controls.itemsubidfield.val();\n                            that.send_submission(subid,filename,itemid,itemname);\n                            break;\n                    }\n                }\n            );\n        },\n\n        re_init_recorder: function(that,recorderid){\n            var rec_div = $('#' + recorderid);\n            rec_div.empty();\n            rec_div.attr('data-alreadyparsed','false');\n            //the initially applied callback lives, so we just do a blank one here\n            var callback = false;\n            cloudpoodll.init(recorderid,callback);\n        },\n\n        insert_new_item: function(that,item){\n            that.controls.noitemscontainer.hide();\n            that.controls.itemscontainer.show();\n            templates.render('mod_cpassignment/itemrow',item).then(\n                function(html,js){\n                    that.controls.thedatatable.row.add($(html)[0]).draw();\n                }\n            );\n        },\n\n        acknowledge_receipt: function(that,item){\n            that.controls.receiptscontainer.show();\n            templates.render('mod_cpassignment/onereceipt',item).then(\n                function(html,js){\n                    that.controls.receiptscontainer.prepend(html);\n                }\n            );\n        },\n\n        send_submission: function(subid,filename, itemid, itemname ){\n            var that=this;\n            var args = {\n                    subid: subid,\n                    filename: filename,\n                    itemname: itemname,\n                    itemid: itemid,\n                    cmid: that.cmid\n                };\n            if(this.authmode==='guest'){\n                args.accesskey=that.accesskey;\n            }else{\n                args.accesskey='none';\n            }\n\n            Ajax.call([{\n                methodname: 'mod_cpassignment_submit_rec',\n                args: args,\n                done: function (ajaxresult) {\n                    var payloadobject = JSON.parse(ajaxresult);\n                    if (payloadobject) {\n                        switch(payloadobject.success) {\n                            case true:\n                                var item = payloadobject.item;\n                                if(that.authmode==='guest'){\n                                    that.acknowledge_receipt(that,item);\n                                }else{\n                                    that.insert_new_item(that,item);\n                                    that.check_item_count(that);\n                                }\n\n                                dialogs.closeModal('#' + that.modulecssclass + '_arec_container');\n                                that.re_init_recorder(that,that.audiorecid);\n                                break;\n\n                            case false:\n                            default:\n                                if (payloadobject.message) {\n                                    log.debug('message: ' + payloadobject.message);\n                                }\n                                dialogs.closeModal('#' + that.modulecssclass + '_arec_container');\n                                that.clear_recorder();\n                                that.re_init_recorder(that.audiorecid);\n\n                        }\n                    }\n                },\n                fail: notification.exception\n            }]);\n\n        },\n    };//end of return object\n\n});"],"file":"listhelper.min.js"}